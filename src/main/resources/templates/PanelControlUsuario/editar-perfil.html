<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>Editar Perfil | Codiplay Dashboard</title>
	<link rel="stylesheet" th:href="@{/assetsPanelUsuaario/styleUsuario.css}" />
	<link rel="stylesheet"
		th:href="@{/https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css}" />
</head>

<body>
	<div class="dashboard-container">
		<aside class="sidebar">
			<div class="logo">
				<a th:href="@{/PanelControlUsuario/inicio}">
					<img th:src="@{/assetsPanelUsuaario/unnamed-removebg-preview.PNG}" alt="Logo Codiplay" />
				</a>
			</div>
			<nav class="main-nav">
				<ul>
					<li class="nav-item">
						<a th:href="@{/PanelControlUsuario/inicio}"><i class="fas fa-home"></i> Inicio</a>
					</li>
					<li class="nav-item">
						<a th:href="@{/PanelControlUsuario/mis_cursos}"><i class="fas fa-book"></i> Mis cursos</a>
					</li>
					<li class="nav-item">
						<a th:href="@{/PanelControlUsuario/mis_logros}"><i class="fas fa-medal"></i> Mis logros</a>
					</li>
				</ul>
			</nav>
			<div class="support-section">
				<a th:href="@{/PanelControlUsuario/soporte}"><i class="fas fa-life-ring"></i> Soporte</a>
			</div>
		</aside>
		<main class="main-content">
			<header class="top-bar">
				<header class="h1eader">
					<h1>Editar Perfil</h1>
				</header>
				<div class="user-info">
					<div class="user-actions">
						<i class="fas fa-info-circle"></i>
						<i class="fas fa-bell"></i>
						<div class="user-dropdown">
							<div class="logo-dropdown-trigger" onclick="toggleDropdown()">
								<img th:if="${usuario != null and usuario.avatar != null and !#strings.isEmpty(usuario.avatar)}"
									th:src="@{'/uploads/avatars/' + ${usuario.avatar}}" alt="User Avatar"
									class="avatar" />
								<img th:unless="${usuario != null and usuario.avatar != null and !#strings.isEmpty(usuario.avatar)}"
									th:src="@{/assetsPanelUsuaario/22b8078e-03d9-49d7-a4a6-f70b4208e8c9-removebg-preview.png}"
									alt="User Avatar" class="avatar" />
							</div>
							<div class="dropdown-content" id="userDropdown">
								<a th:href="@{/PanelControlUsuario/editar-perfil}"><i class="fas fa-user-edit"></i>
									Editar Perfil</a>
								<a th:href="@{/logout}"><i class="fas fa-sign-out-alt"></i> Cerrar Sesión</a>
							</div>
						</div>
					</div>
					<div class="user-name">
						<span th:if="${usuario}" th:text="${usuario.nombre}">Usuario</span>
						<span th:unless="${usuario}">Usuario</span>
						<i class="fas fa-chevron-down"></i>
					</div>
				</div>
			</header>

			<section class="profile-edit-section">
				<div class="profile-edit-card">
					<!-- Mensajes de éxito y error -->
					<div th:if="${mensaje}" class="alert alert-success"
						style="background: #d4edda; color: #155724; padding: 10px; border-radius: 5px; margin-bottom: 15px; text-align: center;">
						<span th:text="${mensaje}"></span>
					</div>
					<div th:if="${error}" class="alert alert-danger"
						style="background: #f8d7da; color: #721c24; padding: 10px; border-radius: 5px; margin-bottom: 15px; text-align: center;">
						<span th:text="${error}"></span>
					</div>

					<form th:action="@{/PanelControlUsuario/editar-perfil}" method="post" enctype="multipart/form-data"
						th:object="${usuario}">
						<div class="form-group">
							<label for="nombre">Nombre</label>
							<input type="text" id="nombre" th:field="*{nombre}" class="form-control" required />
						</div>

						<div class="form-group">
							<label for="apellido">Apellido</label>
							<input type="text" id="apellido" th:field="*{apellido}" class="form-control" />
						</div>

						<div class="form-group">
							<label for="email">Correo Electrónico</label>
							<input type="email" id="email" th:field="*{email}" class="form-control" required />
						</div>

						<div class="form-group">
							<label for="celular">Teléfono</label>
							<input type="text" id="celular" th:field="*{celular}" class="form-control" />
						</div>

						<div class="form-group">
							<label for="documento">Documento</label>
							<input type="text" id="documento" th:field="*{documento}" class="form-control" />
						</div>

						<div class="form-group">
							<label for="avatar">Foto de Perfil</label>
							<div class="avatar-upload">
								<div class="current-avatar">
									<img th:if="${usuario != null and usuario.avatar != null and !#strings.isEmpty(usuario.avatar)}"
										th:src="@{'/uploads/avatars/' + ${usuario.avatar}}" alt="Avatar actual"
										class="avatar-preview" />
									<img th:unless="${usuario != null and usuario.avatar != null and !#strings.isEmpty(usuario.avatar)}"
										th:src="@{/assetsPanelUsuaario/22b8078e-03d9-49d7-a4a6-f70b4208e8c9-removebg-preview.png}"
										alt="Avatar por defecto" class="avatar-preview" />

								</div>
								<input type="file" id="avatar" name="avatarFile" accept="image/*"
									class="form-control" />
								<small class="form-text">Selecciona una nueva imagen para tu perfil (JPG, PNG, GIF -
									Máx. 2MB)</small>
							</div>
						</div>

						<div class="form-actions">
							<button type="submit" class="btn btn-primary">Guardar Cambios</button>
							<a th:href="@{/PanelControlUsuario/inicio}" class="btn btn-secondary">Cancelar</a>
						</div>
					</form>
				</div>
			</section>
		</main>
	</div>

	<script th:src="@{/assetsPanelUsuaario/editar-perfil.js}"></script>
</body>

</html>